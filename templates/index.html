<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåø AI Nh·∫≠n Di·ªán B·ªánh C√¢y Tr·ªìng</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2E8B57, #228B22);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 40px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .upload-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            border: 2px dashed #dee2e6;
            text-align: center;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #2E8B57;
            background: #f0fff0;
        }

        .upload-icon {
            font-size: 4em;
            margin-bottom: 20px;
            color: #2E8B57;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #2E8B57, #228B22);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(46, 139, 87, 0.3);
        }

        .upload-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .preview-section {
            text-align: center;
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .result-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
            display: none;
        }

        .result-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .disease-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #2E8B57;
            margin-bottom: 10px;
        }

        .confidence {
            font-size: 1.1em;
            color: #495057;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .recommendation {
            background: #e7f3ff;
            border-left: 4px solid #1890ff;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2E8B57;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 40px;
            background: #f8f9fa;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #2E8B57;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
        }

        .disease-healthy {
            color: #28a745;
            font-weight: bold;
        }

        .disease-sick {
            color: #dc3545;
            font-weight: bold;
        }

        .confidence-high { color: #28a745; }
        .confidence-medium { color: #ffc107; }
        .confidence-low { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåø AI Nh·∫≠n Di·ªán B·ªánh C√¢y Tr·ªìng</h1>
            <p>C√¥ng ngh·ªá AI gi√∫p ph√°t hi·ªán s·ªõm b·ªánh tr√™n c√¢y tr·ªìng</p>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Upload Section -->
            <div class="upload-section">
                <div class="upload-icon">üì∏</div>
                <h3>T·∫£i ·∫¢nh L√™n</h3>
                <p>Ch·ªçn ·∫£nh l√° c√¢y c·∫ßn ch·∫©n ƒëo√°n (ƒë·ªãnh d·∫°ng JPG, PNG, JPEG)</p>
                
                <input type="file" id="fileInput" class="file-input" accept="image/*">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    üìÅ Ch·ªçn ·∫¢nh
                </button>
                
                <div id="fileName" style="margin: 15px 0; color: #666;"></div>
                
                <button class="upload-btn" onclick="uploadImage()" id="predictBtn" disabled>
                    üîç Ph√¢n T√≠ch Ngay
                </button>
            </div>

            <!-- Preview Section -->
            <div class="preview-section">
                <h3>Xem Tr∆∞·ªõc ·∫¢nh</h3>
                <img id="imagePreview" class="image-preview" alt="Xem tr∆∞·ªõc ·∫£nh">
                <div id="imageInfo" style="margin-top: 10px; color: #666;"></div>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>AI ƒëang ph√¢n t√≠ch ·∫£nh... Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
        </div>

        <!-- Result Section -->
        <div class="result-section" id="resultSection">
            <h3>üìä K·∫øt Qu·∫£ Ph√¢n T√≠ch</h3>
            
            <div class="result-card">
                <div class="disease-name" id="diseaseName">ƒêang ph√¢n t√≠ch...</div>
                <div class="confidence" id="confidenceText">ƒê·ªô tin c·∫≠y: <span id="confidenceValue">0%</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="confidenceBar" style="width: 0%"></div>
                </div>
            </div>

            <div class="recommendation" id="recommendation">
                <strong>üí° Khuy·∫øn ngh·ªã:</strong>
                <p id="recommendationText">ƒêang ph√¢n t√≠ch khuy·∫øn ngh·ªã...</p>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="upload-btn" onclick="resetApp()">
                    üîÑ Ph√¢n T√≠ch ·∫¢nh Kh√°c
                </button>
            </div>
        </div>

        <!-- Features Section -->
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h4>Ph√°t Hi·ªán Nhanh</h4>
                <p>AI ph√¢n t√≠ch ch·ªâ trong v√†i gi√¢y v·ªõi ƒë·ªô ch√≠nh x√°c cao</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üåæ</div>
                <h4>ƒêa D·∫°ng C√¢y Tr·ªìng</h4>
                <p>H·ªó tr·ª£ nhi·ªÅu lo·∫°i c√¢y tr·ªìng ph·ªï bi·∫øn</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üì±</div>
                <h4>D·ªÖ S·ª≠ D·ª•ng</h4>
                <p>Giao di·ªán th√¢n thi·ªán, d·ªÖ d√†ng s·ª≠ d·ª•ng</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üî¨</div>
                <h4>C√¥ng Ngh·ªá AI</h4>
                <p>S·ª≠ d·ª•ng m√¥ h√¨nh deep learning ti√™n ti·∫øn</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>üåø AI Plant Disease Detection - B·∫£o v·ªá m√πa m√†ng c·ªßa b·∫°n</p>
            <p>¬© 2024 - C√¥ng ngh·ªá AI trong n√¥ng nghi·ªáp</p>
        </div>
    </div>

    <script>
        // Hi·ªÉn th·ªã preview ·∫£nh
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // Hi·ªÉn th·ªã t√™n file
                document.getElementById('fileName').textContent = `üìÑ ${file.name}`;
                
                // Hi·ªÉn th·ªã preview ·∫£nh
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    
                    // Hi·ªÉn th·ªã th√¥ng tin ·∫£nh
                    const img = new Image();
                    img.onload = function() {
                        document.getElementById('imageInfo').textContent = 
                            `K√≠ch th∆∞·ªõc: ${img.width}√ó${img.height} pixels`;
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
                
                // K√≠ch ho·∫°t n√∫t ph√¢n t√≠ch
                document.getElementById('predictBtn').disabled = false;
            }
        });

        // Upload v√† ph√¢n t√≠ch ·∫£nh
        async function uploadImage() {
            const fileInput = document.getElementById('fileInput');
            if (!fileInput.files.length) {
                alert('Vui l√≤ng ch·ªçn ·∫£nh tr∆∞·ªõc khi ph√¢n t√≠ch!');
                return;
            }

            // Hi·ªÉn th·ªã loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('L·ªói k·∫øt n·ªëi ƒë·∫øn server');
                }

                const data = await response.json();
                displayResults(data);

            } catch (error) {
                console.error('L·ªói:', error);
                alert('C√≥ l·ªói x·∫£y ra khi ph√¢n t√≠ch ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i!');
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£
        function displayResults(data) {
            const resultSection = document.getElementById('resultSection');
            const diseaseName = document.getElementById('diseaseName');
            const confidenceValue = document.getElementById('confidenceValue');
            const confidenceBar = document.getElementById('confidenceBar');
            const recommendationText = document.getElementById('recommendationText');

            // Gi·∫£ l·∫≠p d·ªØ li·ªáu (thay b·∫±ng data th·ª±c t·ª´ server)
            const result = data.prediction || "Apple__healthy";
            const confidence = data.confidence || 0.95;

            // Ph√¢n t√≠ch k·∫øt qu·∫£
            const [plantType, condition] = result.split('__');
            const isHealthy = condition.toLowerCase() === 'healthy';

            // Hi·ªÉn th·ªã t√™n b·ªánh
            diseaseName.innerHTML = isHealthy ? 
                `<span class="disease-healthy">‚úÖ ${plantType} - Kh·ªèe M·∫°nh</span>` :
                `<span class="disease-sick">‚ö†Ô∏è ${plantType} - ${condition}</span>`;

            // Hi·ªÉn th·ªã ƒë·ªô tin c·∫≠y
            const confidencePercent = (confidence * 100).toFixed(1);
            confidenceValue.textContent = `${confidencePercent}%`;
            
            // C·∫≠p nh·∫≠t progress bar
            confidenceBar.style.width = `${confidencePercent}%`;
            
            // ƒê·ªïi m√†u theo ƒë·ªô tin c·∫≠y
            if (confidence > 0.8) {
                confidenceValue.className = 'confidence-high';
            } else if (confidence > 0.6) {
                confidenceValue.className = 'confidence-medium';
            } else {
                confidenceValue.className = 'confidence-low';
            }

            // Hi·ªÉn th·ªã khuy·∫øn ngh·ªã
            let recommendation = '';
            if (isHealthy) {
                recommendation = 'C√¢y tr·ªìng c·ªßa b·∫°n ƒëang ph√°t tri·ªÉn t·ªët. Ti·∫øp t·ª•c chƒÉm s√≥c v√† theo d√µi ƒë·ªãnh k·ª≥.';
            } else {
                switch(result) {
                    case 'Apple__Apple_scab':
                        recommendation = 'üåø <strong>B·ªánh Gh·∫ª T√°o:</strong> S·ª≠ d·ª•ng thu·ªëc di·ªát n·∫•m, t·ªâa c√†nh th√¥ng tho√°ng, v·ªá sinh v∆∞·ªùn s·∫°ch s·∫Ω.';
                        break;
                    case 'Corn__Common_rust':
                        recommendation = 'üåΩ <strong>B·ªánh G·ªâ S·∫Øt Ng√¥:</strong> S·ª≠ d·ª•ng gi·ªëng kh√°ng b·ªánh, phun thu·ªëc ph√≤ng tr·ª´, lu√¢n canh c√¢y tr·ªìng.';
                        break;
                    default:
                        recommendation = 'C·∫ßn theo d√µi v√† c√≥ bi·ªán ph√°p x·ª≠ l√Ω k·ªãp th·ªùi. Li√™n h·ªá chuy√™n gia n√¥ng nghi·ªáp ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n.';
                }
            }
            recommendationText.innerHTML = recommendation;

            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            resultSection.style.display = 'block';
            
            // Cu·ªôn ƒë·∫øn k·∫øt qu·∫£
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Reset app
        function resetApp() {
            document.getElementById('fileInput').value = '';
            document.getElementById('fileName').textContent = '';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('imageInfo').textContent = '';
            document.getElementById('predictBtn').disabled = true;
            document.getElementById('resultSection').style.display = 'none';
            
            // Cu·ªôn l√™n ƒë·∫ßu trang
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Demo d·ªØ li·ªáu (x√≥a khi k·∫øt n·ªëi v·ªõi server th·∫≠t)
        function demoPredict() {
            const demoData = {
                prediction: "Apple__Apple_scab",
                confidence: 0.87
            };
            displayResults(demoData);
        }
    </script>
</body>
</html>